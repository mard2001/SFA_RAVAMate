<!DOCTYPE html>
<html>
<head>
  <title>
     CMF
  </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
 <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css">
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
 
 <link rel="shortcut icon" href="/img/mdlogo_web.png" type="image/png"/>
 <link rel="stylesheet" href="/css/mdDesign.css"/>

  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css">
  <link rel="stylesheet" href="/js/bootstrap-multiselect-master/dist/css/bootstrap-multiselect.css" type="text/css"/>

  <script type="text/javascript" src="/DATERANGEPICKER/moment.min.js"></script>
    <script type="text/javascript" src="/DATERANGEPICKER/daterangepicker.js"></script>
    <link rel="stylesheet" href="/DATERANGEPICKER/daterangepicker.css">

  <style>
    @media (min-width: 768px) {
      .modal-xl {
        width: 90%;
      max-width:1200px;
      }
    }

    .overModal{
      overflow-y:inherit !important;;
    }

    .font-weight-bold{
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="mySidenav" class="sidenav">
  <div class='image'><img alt='mdbuddylogo' class='logoMd' src='/img/mdbuddylogo_jeff.png'/></div>
    <a href="https://mybuddy-sfa.com/SFA/Dashboard"> <span class='glyphicon glyphicon-home'></span> Dashboard</a>
    <a href="https://mybuddy-sfa.com/SFA/digitalMapping"> <span class='glyphicon glyphicon-map-marker'></span> Digital Mapping</a>
    <a href="https://mybuddy-sfa.com/SFA/customerMapping"> <span class="fa fa-users" aria-hidden="true"></span> Customer Mapping</a>
    <a href="territoryGeofencing"> <span class='glyphicon glyphicon-cog'></span> Territory Geofencing</a>
   <a data-toggle="collapse" href="#collapse1" id='navDrop'> <span class='glyphicon glyphicon-duplicate' id='changeIcon'></span> Reports
    <i class="glyphicon glyphicon-menu-down pull-right"></i> </a>
      <div id="collapse1" class="panel-collapse collapse" style="margin-left: 17px; font-size: 5px !important">
        <a href="salesReport"> Sales Report</a>
        <a href="fastsosyotransaction"> Fastsosyo Transaction</a>
        <a href="salesAudit"> Sales Audit</a>
        <a href="transactionLedger"> Transaction Ledger</a>
        <a href="UnprocessedOrders"> Unprocessed Orders</a>
        <a href="dsr"> DSR</a>
        <a href="dcr"> Daily Collection</a>
        <a href="stockRequest"> Stock Request</a>
        <a href="unuploaded"> Unuploaded</a>
        <a href="BOReport"> BO</a>
        <a href="Stocktake Report"> Stocktake</a>
        <a href="inventory"> Inventory Valuation</a>
        <a href="jobberMaintenance"> Jobber</a>
        <a href="syncreport">Sync Report</a>
        <a href="soaprvreport">SO Approval</a>
      </div>
   <a data-toggle="collapse" href="#collapse2" id='navDrop' class="maintenanceCont"> <span class="fa fa-cogs" aria-hidden="true" id='changeIcon'></span> Maintenance
    <i class="glyphicon glyphicon-menu-down pull-right"></i> </a>
      <div id="collapse2" class="panel-collapse collapse" style="margin-left: 17px; font-size: 9px !important">
        <a href="dataMaintenance"> Data</a>
        <a href="customer"> Customer</a>
        <a href="cmf" class="activeYes">CMF</a>
        <a href="geoReset"> Georeset</a>
        <a href="salesman"> Salesman</a>
        <a href="product"> Product</a>
        <a href="productbtdt"> BTDT Product</a>
        <a href="customerTagging"> Tagging</a>
        <a href="bankmaintenance"> Bank</a>
        <a href="mcpcalibration">MCP Calibration</a>
      </div>
  <!-- <a href="Alert"> <span class='glyphicon glyphicon-envelope'></span> Alert Messages</a> -->
    <hr />
    <a href="https://mybuddy-sfa.com/SFA/v2/dashboard">Switch to New Dashboard</a>
  </div>
  <div id="main">
  <h4 class="display-4 dispMargin">
          <a href="#" id='navBtn' class="btn btn-primary"  style='margin-right: 15px; outline: none;'>
            <span class="glyphicon glyphicon-menu-hamburger"></span> 
          </a>
          <span onclick='closeNav()'>
            <i class="fas fa-clipboard-list"></i> CMF - Customer Maintenance Form
            <!--<span class='pull-right' >
                  <img src="img/colpal.png" alt="nutriasia" style="float:right;">
            </span>-->
              <span class="nav navbar-nav navbar-right">
                <li class="dropdown">
                  <a style='float:right;' href="#" class="dropdown-toggle" data-toggle="dropdown" id='dropThisDown'>
                      <span class="label label-pill label-danger count" style='border-radius: 10px; font-size: 10px;'></span>
                      <span class="fa fa-bell"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-pill">
                    <div id="notificationElement" class="scroll" data-simplebar>
                        <div id='notifs-icon-div'></div>
                    </div>
                    <a type="button" class="btn btn-default btn-block" href='Alert' id='seeAll' >See all</a>
                  </ul>
                </li>
                <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                    <i class="fas fa-user"></i>
                  </a>
                  <ul class="dropdown-menu dropdown-user">
                      <li><a href="Profile.html"><i class="fas fa-user"></i> My Account</a>
                      </li>
                      <li class="divider"></li>
                      <li><a href="#" id="admin-logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                      </li>
                  </ul>
                </li>
              </span>
            </span>
          </h4>

         <div class="panel cust-panel">
               <div class="panel-heading">
                   <i class="fas fa-clipboard-list"></i> <span id="titleHeading"></span>

                   <div id="reportrange1" class="pull-right" style="background-color: transparent; cursor: pointer; color: white;">
                        <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>&nbsp;
                        <span>Filter by Date</span> <b class="caret"></b>
                    </div>

               </div>
                <div class="panel-body" style='background-color:#fff; color: black;'>   
                  <div class="table-responsive">
                    <table class="table table-hover display nowrap customerList" style="width: 100%;">
                       <thead>
                        <tr>
                          <th>STATUS</th>
                          <th>CMFID</th>
                          <th class="">SALES PERSON</th>
                          <th>CUSTCODE</th>
                          <th class="">SOLD TO NAME</th>
                          <th>CONTACT PERSON</th>
                          <th>CUSTOMER CONTACT #</th>
                          <th>EMAIL</th>
                          <th>GEOAREA</th>
                          <th>CHAIN</th>
                          <TH>COVERAGE DAY</TH>
                          <TH>TIN</TH>
                          <TH>POSTALCODE</TH>
                          <th>MUNICIPALITY</th>
                          <th>BARANGAY</th>
                          <th>LONGITUDE</th>
                          <th>LATITUDE</th>
                          <th>OTHER INFO (SHIPTO)</th>
                          <th>OTHER INFO (SOLDTO)</th>
                          <TH>CUSTOMER CLASS</TH>
                          <th>FREQUENCY</th>
                          <th>REQUEST DATE</th>
                        </tr>
                      </thead>
                      <tbody>
                      </tbody>
                    </table>
                  </div>
               </div>
         </div><!--main panel end-->

         <div class="modal fade" id="cmfmodaletails" role="dialog">
            <div class="modal-dialog">
              <!-- Modal content-->
              <div class="modal-content" style="overflow:hidden;">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">CMF Details</h4>
                </div>
                <div class="modal-body overModal">
                    <table class="table table-hover">
                        <tr>
                            <td>CMFID:</td>
                            <td class="font-weight-bold" id="vl_cmfID"></td>
                        </tr>
                        <tr>
                            <td>CUSTCODE:</td>
                            <td class="font-weight-bold" id="vl_custCode"></td>
                        </tr>
                        <tr>
                            <td>SOLD TO NAME:</td>
                            <td class="font-weight-bold" id="vl_soldname"></td>
                        </tr>
                        <tr>
                            <td>SALES PERSON:</td>
                            <td class="font-weight-bold" id="vl_salesperson"></td>
                        </tr>
                        <tr>
                            <td>CUSTOMER MOBILE #:</td>
                            <td class="font-weight-bold" id="vl_custnumber"></td>
                        </tr>
                        <tr>
                            <td>ADDRESS:</td>
                            <td class="font-weight-bold" id="vl_address"></td>
                        </tr>
                        <tr>
                            <td>REQUEST DATE:</td>
                            <td class="font-weight-bold" id="vl_reqdate"></td>
                        </tr>
                    </table>
                     <input type="hidden" name="" id="cmfIDHolder">
                </div>

                <div class="modal-footer" style="float: right;">
                  <small class="text-info pull-left infoFooter"></small>
                  <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-primary" onclick="printCMF()">PRINT CMF</button>
                  </div>
              
              </div>
            </div>
          </div>

          <div class="modal fade" id="duplicateUserModal" role="dialog">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title">SESSION ENDED</h4>
                </div>
                <div class="modal-body">
                  <p>Sorry, your session has been disconnected. Another user is currently using your account.</p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" onclick="cofirmationDupUser()">GOT IT</button>
                </div>
              </div>
            </div>
           </div>
  </div><!--#main-->

    <script src="https://maps.googleapis.com/maps/api/js?v=quarterly&key=AIzaSyAt0Pxe9_3DTav3DmUQzHfgd07s_LcJo7I"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js "></script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.3.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.html5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="/web/web-commons.js"></script>
    <script src="/HASH/md5.js"></script>
    <script src="/HASH/aes.js"></script>
    <script src="/nestle/connectionString/LOCALSTORAGE/storage.js"></script>
    <script type="text/javascript" src="/js/bootbox.min.js"></script>
    <!-- <script type="text/javascript" src="/js/dynamicHeader.js"></script> -->
    <script type="text/javascript" src="/js/bootstrap-multiselect-master/dist/js/bootstrap-multiselect.js"></script>
    <!-- <script src="js/chatApi.js"></script> -->
    <!-- <script type="text/javascript" src="js/duplicate-user.js"></script> -->
    <script>
    var user = localStorage.getItem("adminUserName");
	  var usernm = localStorage.getItem("username");
    $('#customerListSelect').html('<option value="">Select a salesman first..</option>');
    getcompname();
    function getcompname(){
      $.ajax ({
          url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
          type: "GET",
          data: {"type":"GET_COMPANYNAME", "CONN":con_info},
          dataType: "json",
          crossDomain: true,
          cache: false,         
          async: false,   
            success: function(r){ 
                localStorage.setItem('DISTCD', r[0].DIST_CD);
                $('#titleHeading').html(r[0].company.toUpperCase() +' / Customer Maintenance Form / v.1.3');
            },error: function(jqXHR, textStatus, errorThrown) {
                alert('ERROR CONNECTING TO SERVER:\n Please Check your connection settings.');
            }
        });
    } 

    function printCMF(){
        var cmfID = $('#cmfIDHolder').val();
        localStorage.setItem('CMFID', cmfID);
        window.open('print_cmf', '_blank');
    }

      $('.job-inpt-data-h').attr('disabled', 'disabled');
      showNotif();

      $('#navDrop').click(function() {
        $("i", this).toggleClass("glyphicon-menu-up glyphicon-menu-down");
      });
      
      $(document).on('click', '.dropdown-toggle', function(){
        $('.count').html('');
         showNotif('yes');
      });

    //   setInterval(function(){
    //    //loadPopup();
    //    showNotif();
    //  }, 9000); 

      customerData(startPickDate, endPickDate);
      customerDataTable();

      var sourceData;
      function customerData(start, end){
        $.ajax ({
          url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
          type: "GET",
          data: {
                  "type":"GET_CMF_DATA",
                  'start':start,
                  'end':end,
                  "CONN":con_info
                },
          dataType: "JSON",
          crossDomain: true,
          cache: false,     
          async: false,       
            success: function(r){ 
              sourceData = r;
            }
        });
      }
      var tableData;
      function customerDataTable(){
         tableData =  $('table.customerList').DataTable({
                    "dom": 'Bfrtip',
                    "data": sourceData,
                    "scrollX": true,
                    "ordering": true,
                    "columns": [
                        { "data": "STATUS"},
                        { "data": "CMFID"},
                        { "data": "SALESPERSON"},
                        { "data": "CUSTCODE"},
                        { "data": "SOLDTONAME" },
                        { "data": "CUST_CONT_PERSON" },
                        { "data": "CUST_CONTNO" },
                        { "data": "EMAIL" },
                        { "data": "GEOAREA" },
                        { "data": "CHAIN" },
                        { "data": "COV_DAY" },
                        { "data": "TIN" },
                        { "data": "SLD_POSTCODE" },
                        { "data": "SHP_MUNICIPALITY_CITY_PROV" },
                        { "data": "SHP_STREET_BRGY" },
                        { "data": "LONGITUDE" },
                        { "data": "LATITUDE" },
                        { "data": "SHP_OTHERINFO"},
                        { "data": "SLD_OTHERINFO"},
                        { "data": "CUST_CLASS"},
                        { "data": "COV_FREQ"},
                        { "data": "REQ_DATE"}
                    ],
                    // "aoColumnDefs": [
                    // { 
                    //   "sClass": "text-right", "aTargets": [ 3 ],
                    //   // "sClass": "text-center", "aTargets": [ 2 ]  
                    // }
                    //You can also set 'sType' to 'numeric' and use the built in css.           
                 // ],
                  buttons:  [
                          'csv', 'excel',
                          {
                              text: 'Reload',
                              className: 'filterdate_booking',
                              action: function(e, dt, node, config){
                                customerData(startPickDate, endPickDate);
                                tableData.clear().rows.add(sourceData).draw();
                              }
                          }
                  ],
                    "language": {
                      "emptyTable": "No available records as of now."
                    },
                    // "aaSorting": [[ 0, "desc" ]],
                    rowCallback: function(row, data, index){
                      var statIndicator = data.STATUS.toString();
                    //   var salesmanIndi = $(row).find('td:eq(4)').text();
                    //   var mdCode = data.partnerID.toString();
                    //   // console.log(salesmanOBj);

                      
                      
                      if($.trim(statIndicator) == '1'){ 
                        // $(row).find('td:eq(2)').text('BOOKING');
                        $(row).find('td:eq(0)').css({'color': 'white', "background-color": "#e06335", "text-align":"center"});
                        $(row).find('td:eq(0)').text('Pending');
                      }else if($.trim(statIndicator) == '2'){
                        $(row).find('td:eq(0)').text('Approved');
                        $(row).find('td:eq(0)').css({'color': 'white', "background-color": "#00A86B", "text-align":"center"});
                      }else{
                        $(row).find('td:eq(0)').text('Cancelled');
                        $(row).find('td:eq(0)').css({'color': 'white', "background-color": "red", "text-align":"center"});
                      }

                    //   if(salesmanIndi == null || salesmanIndi == 'null' || salesmanIndi == ''){
                    //     $(row).find('td:eq(4)').text('---');
                    //   }
                    //   // else{
                    //   //   var salesmanOBj = getSalesmanDetails(mdCode);
                    //   //   $(row).find('td:eq(4)').text(mdCode+'_'+salesmanOBj[0].Salesman);
                    //   // }
                  }
           });

        $('table.customerList tbody').on('click', 'tr', function () {
            var tr = $(this).closest('tr');
            var row = tableData.row(tr);
            cmfDetails(row.data());
        });

        function cmfDetails(r){
            $('#vl_cmfID').html(r.CMFID);
            $('#vl_custCode').html(r.CUSTCODE);
            $('#vl_soldname').html(r.SOLDTONAME);
            $('#vl_salesperson').html(r.SALESPERSON);
            $('#vl_custnumber').html(r.CUST_CONTNO);
            $('#vl_address').html(r.SHP_STREET_BRGY);
            $('#vl_reqdate').html(r.REQ_DATE);
            $('#cmfIDHolder').val(r.cID);

            $('#cmfmodaletails').modal('show');
            
        }
      }

      function displaycustomer(cust){
        if(cust == 'NEW_CUSTOMER'){
          return cust;
        }else{
          return getCustomerName(cust);
        }
      }

      function islockOnverifyer(r){
        
        if(r == 0){
          return '<strong style="color: red;">NO</strong>';
        }
         return '<strong style="color: #5ee663;">YES</strong>';
      }

      datePicker();
      var startPickDate, endPickDate;
      function datePicker(){
       var start = moment().subtract(29, 'days');
        var end = moment();

        $('#reportrange1').daterangepicker({
            "alwaysShowCalendars": true,
            "startDate": start,
            "endDate": end,
            "maxDate": moment(),
            "applyClass": "btn-primary",
            "autoApply": false,
            ranges: {
               'Today': [moment(), moment()],
               'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
               'Last 7 Days': [moment().subtract(6, 'days'), moment()],
               'This Month': [moment().startOf('month'), moment().endOf('month')],
               'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            }
        }, function(start, end, label) {
            $('#reportrange1 span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
            startPickDate = start.format('YYYY-MM-DD');
            endPickDate = end.format('YYYY-MM-DD')
          });

        $('#reportrange1').on('apply.daterangepicker', function(ev, picker) {
          $('#stockRequest_TAB').hide();
          var start = picker.startDate.format('YYYY-MM-DD');
          var end = picker.endDate.format('YYYY-MM-DD');
          customerData(start, end);
          tableData.clear().rows.add(sourceData).draw();
        });
      }

      function exec_insertCustomer(){
        var r = confirm("Press 'OK' to proceed.");
        if(r){
          $('#addJobberBtn').html('<i class="fa fa-spinner fa-spin"></i> updating.. ');
          $( "#addJobberBtn").prop( "disabled", true );
          var custCode = $('#custCodeH').val();
          $.ajax ({
            url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
            type: "GET",
            data: {
                    "type":"UPDATE_ORDERTYPE", 
                    "CONN":con_info,
                    "custCode":custCode
                  },
            dataType: "JSON",
            crossDomain: true,
            cache: false,     
            async: false,       
              success: function(r){ 
                if(r){
                  customerData();
                  tableData.clear().rows.add(sourceData).draw();
                  alert('Customer succesfully updated!');
                }else{
                  alert('UNABLE TO INSERT: Customer is already in the jobber list!');
                }
                  $("#addJobberBtn").prop( "disabled", false );
                  $('#addJobberBtn').html('Add');
               
              },error: function(XMLHttpRequest, textStatus, errorThrown) {
                alert('ERROR CUSTOMER UPDATE: ' + JSON.stringify(XMLHttpRequest.responseText));
                $( "#addJobberBtn").prop( "disabled", false );
                $('#addJobberBtn').html('Add');
              }
          });
        }
      }

      function exec_insertCustomer_revert(){
        var r = confirm("Press 'OK' to proceed.");
        if(r){
          $('#revertBtn').html('<i class="fa fa-spinner fa-spin"></i> updating.. ');
          $( "#revertBtn").prop( "disabled", true );
          var custCode = $('#custCodeH').val();
          $.ajax ({
            url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
            type: "GET",
            data: {
                    "type":"UPDATE_ORDERTYPE_REVERT", 
                    "CONN":con_info,
                    "custCode":custCode
                  },
            dataType: "JSON",
            crossDomain: true,
            cache: false,     
            async: false,       
              success: function(r){ 
                if(r){
                  customerData();
                  tableData.clear().rows.add(sourceData).draw();
                  alert('Customer succesfully updated!');
                }else{
                  alert('UNABLE TO INSERT: Customer is already in the jobber list!');
                }
                  $("#revertBtn").prop( "disabled", false );
                  $('#revertBtn').html('Add');
               
              },error: function(XMLHttpRequest, textStatus, errorThrown) {
                alert('ERROR CUSTOMER UPDATE: ' + JSON.stringify(XMLHttpRequest.responseText));
                $( "#revertBtn").prop( "disabled", false );
                $('#revertBtn').html('Add');
              }
          });
        }
      }

      function showNotif(view=''){
         $.ajax ({
          url: "../geofencing/GeofencingAPI.php",
          type: "GET",
          data: {"type":"view_notifications_icon_"+user, "view":view},
          dataType: "JSON",
          crossDomain: true,
          cache: false,            
            success: function(response){ 
           // console.log('Notification function has been refresh');                
            $("#notifs-icon-div").html(response.notification);
              if(response.unseen_notification > 0)
              {
               $('.count').html(response.unseen_notification);
              }
            }
        });
      }

    function getToken(mdCode){
        var token = '';
        $.ajax ({
            url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
            type: "GET",
            data: {
                    "type":"GET_USER_TOKEN",
                    "CONN":con_info,
                    "mdCode":mdCode
                },
            dataType: "json",
            crossDomain: true,
            cache: false,
            async: false,         
            success: function(r){
            token = r;
            }
        });
        return token;
    }

    function getSalesmanDetails(mdCode){
        var details = [];
        $.ajax ({
            url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
            type: "GET",
            data: {
                    "type":"GET_AIO_SALESAMAN_DETAILS",
                    "CONN":con_info,
                    "mdCode":mdCode
                },
            dataType: "json",
            crossDomain: true,
            cache: false,
            async: false,         
            success: function(r){
              details = r;
            }
        });
        return details;
    }

    function getCustomerName(custCode){
        var customer = '';
        $.ajax ({
            url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
            type: "GET",
            data: {
                    "type":"GET_MYBUDDY_STORENAME",
                    "CONN":con_info,
                    "custCode":custCode
                },
            dataType: "json",
            crossDomain: true,
            cache: false,
            async: false,         
            success: function(r){
              customer = r[0].custCode+'_'+r[0].custName;
            }
        });
        return customer;
    }

    function getAioStoreToken(storeID){
      var token = '';
        $.ajax ({
            url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
            type: "GET",
            data: {
                    "type":"GET_AIO_TOKEN",
                    "CONN":con_info,
                    "storeID":storeID
                },
            dataType: "json",
            crossDomain: true,
            cache: false,
            async: false,         
            success: function(r){
              token = r;
            }
        });
        return token;
    }


   
        
    $(window).bind("load", function () {
        $('#work-in-progress').fadeOut();
    });

    function myFunction() {
        var x = document.getElementById("myTopnav");
        if (x.className === "topnav") {
            x.className += " responsive";
        } else {
            x.className = "topnav";
        }
    } 


    (function($) {
      $.fn.clickToggle = function(func1, func2) {
          var funcs = [func1, func2];
          this.data('toggleclicked', 0);
          this.click(function() {
              var data = $(this).data();
              var tc = data.toggleclicked;
              $.proxy(funcs[tc], this)();
              data.toggleclicked = (tc + 1) % 2;
          });
          return this;
      };
    }(jQuery));

     
    $("#navBtn").clickToggle(function() {   
        openNav();
      }, function() {
        closeNav();
    });
      
    function imgError2(image) {
      image.onerror = "";
      image.src = "../img/salesmanPic.jpg";
      return true;
    }  
       
    function openNav() {
        document.getElementById("mySidenav").style.width = "270px";
        document.getElementById("main").style.marginLeft = "270px";
    }

    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
        document.getElementById("main").style.marginLeft= "0";
    }

    var infoWindow = new google.maps.InfoWindow;
    function showmarker(latval, lngval, storeName, address){
      var contentString = '<p>Storename: <strong>' + storeName.toUpperCase() + '</strong></p>'+
                          'Address: <strong>'+ address+'</strong>';
        var myLatLng = { lat: parseFloat(latval), lng: parseFloat(lngval) };
        var marker = new google.maps.Marker({
            position: myLatLng,
            map,
            infowindow: infoWindow,
            content: contentString,
            title: storeName,
        });
        map.setCenter(marker.getPosition());  
        infoWindow.setContent(contentString);
        infoWindow.open(map, marker);
    }
    

</script>

     
</body>
</html> 

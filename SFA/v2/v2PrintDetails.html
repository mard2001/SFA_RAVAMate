<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>INVOICE</title>
    <link rel="icon" href="img/mybuddyLogo.jpg" />

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        body, html{
            margin: 0;
            padding: 0;
            font-size: 13px;

        }

        #inv_tbody table tr td{
            font-size: 12px;
        }

        #inv_tbody table{
            width: 1200px;
        }
        
        .tab1{
            margin-top: 60px;
            margin-left: 50px;
            width: 1200px;
            margin-bottom: 50px;
        }

        .tab1tr2{
            margin-left: 100px !important;
        }

        .tabl2{
            margin-left: 50px;
            width: 1200px;
        }

        .tabl3{
            margin-left: 50px;
            width: 1200px;
            margin-top: 50px;
            /* max-height: 473px !important; */
        }

        .tabl4{
            width: 1200px;
            margin-top: 21px;
            /* margin-top: 473px; original*/
            /* margin-top: 470px; */
        }

        .tabl2 tr td span{
            margin-left: 100px;
        }

        .btn{
            background-color: #333;
            height: 40px;
            width: 100px;
            border-radius: none;
            outline: none;
            padding: 10px;
            color: white;
            margin-left: 10px;
        }

        .printBtn{
            margin-top: 10px;
            background-image: linear-gradient(#031841, #051A66);
            border-radius: 10px;
        }

        .printBtn:hover{
            cursor: pointer;
            background-image: linear-gradient(#1a418f, #051A66);
        }

    </style>
</head>
<body style="width: 100%;" class="div">
    <button class="btn printBtn" onclick="printthis()">PRINT</button>
    <table class="tab1">
        <tr>
            <td>
                <span class="custName"></span><br>
                <span class="">-</span><br>
                <span class="custAddress"></span>
            </td>
            <td class="tab1tr2">
                <span class="custName"></span><br>
                <span class="">-</span><br>
                <span class="custAddress"></span>
            </td>
        </tr>
    </table>

    <table class="tabl2" style="height: 50px !important;">
        <tr style="padding-bottom: 30px !important;">
            <td><span id="custCode"></span></td>
            <td><span id="iscodCash"></span></td>
            <td style="text-align: right;"><span></span></td>
        </tr>
        <tr>
            <td><span id="delCustomerName"></span></td>
            <td><span id="salesmanCodeandSO"></span></td>
            <td style="text-align: right;"><span id="delDate"></span></td>
        </tr>
    </table>

    <div class="tabl3">
        <div id="inv_tbody">

        </div>
    </div>

    <div class="tabl4">
        <div class="div1" style="text-align: right !important; float:left; margin-left: 470px; margin-right: 220px; font-size: 14px !important;">
            <span class="spanT" id="vatableSales"></span><br>
            <span class="spanT"></span><br>
            <span class="spanT"></span><br>
            <span class="spanT" id="vatAmount"></span>
        </div>

        <div class="div2" style="float:right; font-size: 14px !important; text-align: right !important;">
            <span class="spanT" style="text-align:right; padding-left: 25px !important;" id="totalVatSales"></span><br>
            <span class="spanT" style="text-align:right; padding-left: 25px !important;" id="lessVat"></span><br>
            <span class="spanT" style="text-align:right; padding-left: 25px !important;" id="amountNetofVat"></span><br>
            <span class="spanT" style="text-align:right; padding-left: 25px !important;">0</span><br>
            <span class="spanT" style="text-align:right; padding-left: 25px !important;" id="amountDue"></span><br>
            <span style="padding-left: 25px !important; text-align:right;" id="addVat" class="spanT"></span><br>
            <span style="margin-bottom: 30px !important; padding-left: 25px !important; text-align:right;" id="totalAmount" class="spanT"></span>
            <!-- <span style="margin-top: 30px !important; " class="spanT" style="text-align:right;">LAYTE / MALAPAG</span> -->
        </div>
    </div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="/DATERANGEPICKER/moment.min.js"></script>
    <script src="/HASH/md5.js"></script>
    <script src="/HASH/aes.js"></script>
    <script src="/nestle/connectionString/LOCALSTORAGE/storage.js"></script>
    <script>
          var salesman = localStorage.getItem("salesmanINV");
          var transID = localStorage.getItem("transactionIDINV");
          var custCode = localStorage.getItem("custCodeINV");
          var custName = localStorage.getItem("custNameINV");
          var contactPerson = localStorage.getItem("contactPersonINV");
          var sku = localStorage.getItem("skuINV");
          var amount = localStorage.getItem("amountINV");
          var address = localStorage.getItem("addressINV");   
          var deldate = localStorage.getItem("deldateINV");  
          var refNo = localStorage.getItem("refNoINV");  
          var salesmanCode = localStorage.getItem("salesmanCodeINV"); 
          
          $('.custAddress').html(address);
          $('.custName').html(custName);
          $('#salesmanCodeandSO').html(salesmanCode+' S.O#'+refNo);
          $('.contactPerson').html(contactPerson);
          $('#SONumber').html(refNo);
          $('#delDate').html(deldate);  
          $('#custCode').html(custCode);
          $('#delCustomerName').html('DELIVERY TO '+ custName);
          $('#delDate').html(deldate);
          table_inv_details(transID, custCode);
          computationDetails(transID);

          function printthis(){
              $('.btn').hide();
              window.print();
              $('.btn').show();
          }

          function iscodChecker(custCode){
            var isTmp = custCode.slice(0, 3);
            if(isTmp.toUpperCase() == 'TMP'){
                //console.log('isTmp: ' + custCode);
                // $('#iscodCash').html('---');
                return '---';
            }else{
                //$('#iscodCash').html('COD CASH');
                //console.log('notisTmp: ' + custCode);
                return 'COD CASH';
            }
          }

          function table_inv_details(transactionID, custCode){
              
            var isTmp = custCode.slice(0, 3);
            if(isTmp.toUpperCase() == 'TMP'){
                console.log('isTmp: ' + custCode);
                $('#iscodCash').html('---');
            }else{
                $('#iscodCash').html('COD CASH');
                console.log('notisTmp: ' + custCode);
            }

            $.ajax ({
                url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
                type: "GET",
                data: {"type":"salesReport_details", "transactionID":transactionID, "CONN":con_info},
                dataType: "json",
                crossDomain: true,
                cache: false,  
                async: false,          
                success: function(r){
                    if(r.length <= 27){
                        var cont = '<table>', counter = 0;
                        $('#refnoH').html(r[0].refno);
                        for(var x = 0; x < r.length; x++){
                        counter++;
                        cont += '<tr>'+
                                    '<td style="text-align: left !important;">'+r[x].stockCode+'</td>'+
                                    '<td style="text-align: left !important;">'+r[x].quantity+'</td>'+
                                    '<td style="text-align: left !important;">'+r[x].description+'</td>'+
                                    '<td style="">'+r[x].unitPrice+'</td>'+
                                    '<td style="text-align: right !important;">'+r[x].amount+'</td>'+
                                '</tr>';
                        }

                        var max = 27;
                        var counter2 = max - r.length;

                        for(var x = 0; x < counter2; x++){
                        var newCount = (counter + 1) + x;
                            cont += '<TR>'+
                                        '<td><span style="width: 13px; height: 10px;">&nbsp;</span></td>'+
                                        '<td></td>'+
                                        '<td></td>'+
                                        '<td></td>'+
                                        '<td></td>'+
                                    '</TR>';
                        }
                        cont += '</table>'
                        $('#inv_tbody').html(cont);
                    }else{
                        var cont2 = '<table>', counter2 = 0;
                        $('#refnoH').html(r[0].refno);
                        for(var x = 0; x < r.length; x++){
                        counter2++;
                        if(counter2 == 27){
                            counter2 = 0;
                            cont2 += '</table>'+
                                    '<div style="margin-top: 1400px !important; margin-bottom: 40px;">-</div>'+
                                    '<div style="width: 1200px;">'+
                                            '<table class="tab1" style="margin-bottom: 50px; margin-top: 40px !important;">'+
                                                '<tr>'+
                                                    '<td>'+
                                                        '<span class="custName">'+custName+'</span><br>'+
                                                        '<span class="contactPerson">-</span><br>'+
                                                        '<span>'+address+'</span>'+
                                                    '</td>'+
                                                    '<td class="tab1tr2">'+
                                                        '<span class="custName">'+custName+'</span><br>'+
                                                       ' <span class="contactPerson">-</span>'+
                                                       '<span>'+address+'</span>'+
                                                    '</td>'+
                                               ' </tr>'+
                                           '</table>'+

                                            '<table class="tabl2">'+
                                                '<tr>'+
                                                    '<td><span id="custCode">'+custCode+'</span></td>'+
                                                    '<td><span id="iscodCash">'+iscodChecker(custCode)+'</span></td>'+
                                                    '<td style="text-align: right;"><span></span></td>'+
                                                '</tr>'+
                                                '<tr>'+
                                                    '<td><span id="delCustomerName">DELIVERY TO '+ custName+'</span></td>'+
                                                    '<td><span id="salesmanCodeandSO">'+salesmanCode+' S.O#'+refNo+'</span></td>'+
                                                   ' <td style="text-align: right;"><span id="delDate">'+deldate+'</span></td>'+
                                                '</tr>'+
                                            '</table>'+

                                    '</div>'+
                                    '<table style="margin-top: 50px;">'+
                                    '<tr>'+
                                        '<td style="text-align: left !important;">'+r[x].stockCode+'</td>'+
                                        '<td style="text-align: left !important;">'+r[x].quantity+'</td>'+
                                        '<td style="text-align: left !important;">'+r[x].description+'</td>'+
                                        '<td style="">'+r[x].unitPrice+'</td>'+
                                        '<td style="text-align: right !important;">'+r[x].amount+'</td>'+
                                    '</tr>';
                            
                        }else{
                            cont2 += '<tr>'+
                                        '<td style="text-align: left !important;">'+r[x].stockCode+'</td>'+
                                        '<td style="text-align: left !important;">'+r[x].quantity+'</td>'+
                                        '<td style="text-align: left !important;">'+r[x].description+'</td>'+
                                        '<td style="">'+r[x].unitPrice+'</td>'+
                                        '<td style="text-align: right !important;">'+r[x].amount+'</td>'+
                                    '</tr>';

                            
                               
                            }

                            
                        }
                        

                        var max = 27;
                        var counter3 = max - (r.length % 27);

                        for(var x = 0; x < counter3; x++){
                            cont2 += '<TR>'+
                                        '<td><span style="width: 13px; height: 10px;">&nbsp;</span></td>'+
                                        '<td></td>'+
                                        '<td></td>'+
                                        '<td></td>'+
                                        '<td></td>'+
                                    '</TR>';
                        }

                        
                        cont2 += '</table>';

                        $('#inv_tbody').html(cont2);
                    }
                }
            });
          }

          function computationDetails(transactionID){
            $.ajax ({
                url: GLOBALLINKAPI+"/nestle/connectionString/applicationipAPI.php",
                type: "GET",
                data: {"type":"INV_COMP_DETAILS", "transactionID":transactionID, "CONN":con_info},
                dataType: "json",
                crossDomain: true,
                cache: false,  
                async: false,          
                success: function(r){
                    $('#totalVatSales').html(r[0].TotalVatSales);
                    $('#lessVat').html(r[0].LessVat);
                    $('#amountNetofVat').html(r[0].AmountNetofVAT);
                    $('#amountDue').html(r[0].AmountDue);
                    $('#addVat').html(r[0].AddVAT);
                    $('#totalAmount').html(r[0].totalAmount);
                    $('#vatableSales').html(r[0].VatableSales);
                    $('#vatAmount').html(r[0].VATAmount);

                }
            });
          }
    </script>
</body>
</html>
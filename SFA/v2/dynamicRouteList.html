<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- <meta http-equiv="Content-Security-Policy" content="connect-src 'self' https://fastdevs-api.com;"> -->
    <title>DYNAMIC LOAD PLANNING </title>
    <link rel="icon" class="pageIconLink" href="" />

    <!-- BOOTSTRAP -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"/>

    <!-- GOOGLE MATERIAL ICON -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
    <!-- PICTOGRAMMERS ICON -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.3.67/css/materialdesignicons.min.css" />
    
    <!-- FONT AWESOME -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- CSS STYLESHEETS -->
    <link rel="stylesheet" href="constant/dynamicColor_stylesheet.css">
    <link rel="stylesheet" href="css/offcanvas_stylesheet.css">
    <link rel="stylesheet" href="css/routeList_stylesheet.css">
    <link rel="stylesheet" href="css/latestDatatable_stylesheet.css">

    <!-- SWAL SWEET ALERT 2 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <!-- DATE PICKER -->
    <link rel="stylesheet" href="DATERANGEPICKER/daterangepicker.css">

    <!--DATA TABLES CSS LZATEST VERSION-->
    <link rel="stylesheet" href="Commonusrs/DataTables/datatables.css"/>

    <!--=================================virtual select import-=============================-->
    <link rel="stylesheet" href="css/virtual-select/virtual-select.min.css"  type="text/css"/>
    <script src="js/virtual-select/virtual-select.min.js"></script>

</head>
<body>
    <div class="mainDiv container-fluid">
        <div class="headerDiv d-flex justify-content-between align-items-center py-3" style="color: #FFF;">
            <div class="leftHeader d-flex align-items-center mx-3">
                <button class="btn menubtn" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu" aria-controls="offcanvasExample" style="color: #FFF;">
                    <span class="material-symbols-outlined">
                        menu
                    </span>
                </button>
                <div id="navbarCompanyDetails" class="d-flex">
                </div>
            </div>
            <h1 class="text-center">Dynamic Load Planning</h1>
            <div class="rightHeader d-flex justify-content-end align-items-center mx-3" id="defaultrightHeader" style="width: 260px;">
                <div class="navbarDropdowns"></div>
            </div>
        </div>

        <div class="contentDiv ">
            <div class="salesRepDivHeader d-flex justify-content-between px-3 py-3">
                <div class="leftsideHeader">
                    <span class="mdi mdi-web" style="font-size: 20px;"></span>
                    <span id="titleHeading"></span>
                </div>
                <div class="righsideHeader d-flex">
                    <button class="exportBtn mx-2" onclick="syncBTDTOrder()"><span class="mdi mdi-refresh"></span> Refresh</button>
                    <button class="exportBtn mx-2" onclick="exec_view_stocktakeModal()"><span class="mdi mdi-file-document-refresh"></span> Confirm Stock Request</button>
                    <!-- <button class="exportBtn" onclick="usemapdr()"><i class="mdi mdi-map-legend"></i> Use Map </button> -->
                </div>
            </div>

            <div class="contentTableDiv px-3 mx-1 mt-2" >
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="route-tab" data-bs-toggle="tab" data-bs-target="#route-tab-pane" type="button" role="tab" aria-controls="route-tab-pane" aria-selected="true">Route List</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="transac-tab" data-bs-toggle="tab" data-bs-target="#transac-tab-pane" type="button" role="tab" aria-controls="transac-tab-pane" aria-selected="false">Transaction List</button>
                    </li>
                </ul>

                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="route-tab-pane" role="tabpanel" aria-labelledby="route-tab" tabindex="0" style="background-color: #FFF; padding: 10px;border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; border-top-right-radius: 10px;">
                        <div id="pending_stockrequestlist">
                            <table class="table table-hover display nowrap tabtables pendingTBL" style="width: 100% !important;">
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="transac-tab-pane" role="tabpanel" aria-labelledby="transac-tab" tabindex="0" style="background-color: #FFF; padding: 10px;border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; border-top-right-radius: 10px;">
                        <div id="approved_stockrequestlist">
                            <table class="table table-hover display nowrap tabtables approvedTBL" style="width: 100% !important;">
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasMenu" aria-labelledby="offcanvasMenuLabel">
            <div class="offcanvas-header d-flex justify-content-between">
                <button type="button" class="btn" data-bs-dismiss="offcanvas" aria-label="Close">
                    <span class="material-symbols-outlined">
                        menu
                    </span>
                </button>
                <div class="rightHeader d-flex justify-content-around align-items-center mx-3" id="smallScreenrightHeader">
                    <div class="navbarDropdowns"></div>
                </div>
            </div>
            <div class="offcanvas_headTitleDiv">
            </div>
            <div class="offcanvas-body px-0">
                <div class="list-group">
                    <div id="sidebarTabItems">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="updatecustomerModal" role="dialog" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"> Dynamic Route Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="transactionIDHolder">
                    <input type="hidden" id="salesmanTypeHolder">
                    <!-- <div class="row">
                        <div class="col-xs-12 col-sm-6 col-md-4 modalBodyTitle">
                            <div class="mb-1">
                                <label for="dist_plateno" class="form-label">Plate no:</label>
                                <span type="text" class="form-control" id="dist_plateno"></span>
                            </div>
                            <div class="mb-1">
                                <label for="disp_ttransaction" class="form-label">Total Drops:</label>
                                <span type="text" class="form-control" id="disp_ttransaction"></span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-6 col-md-4 modalBodyTitle">
                            <div class="mb-1">
                                <label for="disp_loadingcap" class="form-label">Loading Capacity:</label>
                                <span type="text" class="form-control" id="disp_loadingcap"></span>
                            </div>
                            <div class="mb-1">
                                <label for="disp_totalamount" class="form-label">Total Amount:</label>
                                <span type="text" class="form-control" id="disp_totalamount"></span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-6 col-md-4 modalBodyTitle">
                            <div class="mb-1">
                                <label for="disp_balance" class="form-label">Balance:</label>
                                <span type="text" class="form-control" id="disp_balance"></span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-6 col-md-4">
                            <div class="my-3">
                                <button class="btn btn-info btn-sm" onclick="view_route_group_details()">View Route Group Details</button>
                            </div>
                        </div>
                    </div> -->
                  
                    <table class="table table-striped table-sm">
                        <input type="hidden" name="listStatus" id="listStatus">
                        <tr>
                            <td>Transaction ID:</td>
                            <td><strong id="dist_transacID"></strong> - <span id="dist_transacStatus"></span></td>
                        </tr>

                        <tr>
                            <td>Plate no:</td>
                            <td><strong id="dist_plateno"></strong></td>
                        </tr>

                        <tr>
                            <td>Total Drops:</td>
                            <td><strong id="disp_ttransaction"></strong></td>
                        </tr>

                        <tr>
                            <td>Loading Capacity:</td>
                            <td><strong id="disp_loadingcap"></strong></td>
                        </tr>

                        <tr>
                            <td>Total Amount:</td>
                            <td><strong id="disp_totalamount"></strong></td>
                        </tr>

                        <tr>
                            <td>Balance:</td>
                            <td><strong id="disp_balance"></strong></td>
                        </tr>
                        <tr>
                            <td>Action</td>
                            <td><button class="btn btn-info btn-sm" onclick="view_route_group_details()">View Route Group Details</button></td>
                        </tr>
                    </table>
                    <hr class="text-primary">

                    <div class="alreadyconfirmed">
                        <p><i class="fa fa-circle text-primary"></i> Available Transaction for Dynamic Routing</p>
                        <table class="table table-hover display nowrap tabtables uptDynamicTBL" style="width: 100% !important;">
                            <tbody></tbody>
                        </table>
                    </div>

                    <input type="hidden" id="cancelRouteIDRefHolder">
                    <input type="hidden" id="platenoRouteHolder">
                    <input type="hidden" id="unloadingDateRouteHolder">

                </div>
                <div class="modal-footer d-flex justify-content-between">
                    <div>
                        <button type="button" class="btn btn-warning printloadplanbtn mx-1" style="float: left;" onclick="reassignLoadPlan()">Re-assign Load Plan</button>
                    </div>
                    <div>
                        <button type="button" class="btn btn-danger alreadyconfirmed mx-1" style="float: left;" onclick="cancelroutelist()">Remove</button>
                        <!-- as per sir roy mag una dapat ang pick list sa create src septebmer 3, 2025 2:31 pm -->
                        <button type="button" class="btn btn-warning alreadyconfirmed mx-1" style="float: left;" onclick="printPickList()">Print Pick List</button>
                        <button type="button" class="btn btn-success alreadyconfirmed mx-1" style="float: left;" onclick="confirmroutelist()">Create SRS</button>
                        <!-- <button type="button" class="btn btn-primary alreadyconfirmed" id='updateCustomertbtn' onclick="execute_update()">Update</button> -->
                        <button type="button" class="btn btn-primary printloadplanbtn mx-1" onclick="printloadplan()"><i class="fa fa-print"></i> Print Load Plan</button>
                        <button type="button" class="btn btn-outline-secondary mx-1" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="duplicateUserModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">SESSION ENDED</h4>
                </div>
                <div class="modal-body">
                    <p>Sorry, your session has been disconnected. Another user is currently using your account.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="cofirmationDupUser()">GOT IT</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="filterTransModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Filter Data</h4>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                         <tr>
                            <td>Operation Type</td>
                            <td class="text-center">
                                <select name="" id="operation_type" class="form-control">
                                    <option value="" selected disabled hidden>Choose here..</option>
                                    <option value="BTDT-S">BTDT</option>
                                    <option value="INV_ERIC">BOOKING</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Date</td>
                            <td class="text-center">
                                <div class="filterdate_extruct">
                                    <span style="color: #6a6a6a; cursor: pointer;">Click Here To Filter Date</span>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn proceedBtn" onclick="filter_dynaroute_transaction()">Proceed</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="dynamicRoute_inside_details" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Dynamic Route - Transaction Details</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-hover display nowrap tabtables transactionDetails" style="width: 100% !important;">
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="reassign_dynamicrouteModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Re-assign Dynamic Route</h4>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <tr>
                            <td>Vehicle</td>
                            <td>
                                <select class="form-control" id="driverselect_ra">
                                </select>
                            </td>
                        </tr>
                    </table>

                    <input type="hidden" id="cIDreassignHolder">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn proceedBtn" id="maincreationdrl" onclick="exec_dynaroute_reassign()">Proceed</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="updateDyanamicRouteModal" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Assign Dynamic Route</h4>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <tr>
                            <td>Vehicle</td>
                            <td>
                                <!-- <select class="form-control" id="driverselect">
                                </select> -->
                                <select id="driverselect" name="native-select" placeholder="Choose here" data-search="true">
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>Loading Capacity</td>
                            <td>
                                <input type="text" id="loadingCapHolder" class="form-control" disabled> 
                            </td>
                        </tr>
                        <tr>
                            <td>Unloading Date</td>
                            <td>
                            <input type="date" class="form-control" id="unloadingDate">
                            </td>
                        </tr>
                        <tr>
                            <td>Total Drops</td>
                            <td>
                                <input type="text" id="totalTransactionHolder" class="form-control" disabled>
                            </td>
                        </tr>
                        <tr>
                            <td>Total Amount</td>
                            <td>
                                <input type="text" id="totalAmountHolderDisplay" class="form-control" disabled>
                            </td>
                        </tr>
                    </table>

                    <input type="hidden" id="totalAmountHolder">
                    <input type="hidden" id="cIDhoLDERforUpdate">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn proceedBtn" id="maincreationdrl" onclick="exec_dynaroute_transaction()">Proceed</button>
                    <button type="button" class="btn btn-primary" id="updatedrl" onclick="exec_update_dynaroute_transaction()">Update</button>
                </div>
            </div>
        </div>
    </div>
    

    <div class="modal fade" id="syncbtdtDriverModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Select Booking Date to Refresh</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <tr>
                            <td>Booking Date:</td>
                            <td>
                                <span class="dssdatePicker" style="text-align: left; margin-left: 70px;"> &nbsp; 
                                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                                    <span class="datestring"></span>
                                </span>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn proceedBtn" data-bs-dismiss="modal" onclick="execSyncBtdt()">Execute</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="syncStockRequestModal" role="dialog" data-bs-backdrop="static">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Confirm Stock Request</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-2">
                        <label for="colFormLabel" class="col-sm-3 col-form-label col-form-label-sm">SALESMAN</label>
                        <div class="col-sm-9">
                            <select id="salesmanList_stk" name="salesmanList_stk[]" multiple></select>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <label for="colFormLabel" class="col-sm-3 col-form-label col-form-label-sm">DATE</label>
                        <div class="col-sm-9">
                            <span class="dssdatePicker" style="text-align: left; margin-left: 70px;"> &nbsp; 
                                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                                    <span class="datestring"></span>
                                </span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn proceedBtn" data-bs-dismiss="modal" onclick="exec_stockTake()">Execute</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- DATA TABLES JS LATEST VERSION -->
    <script src="Commonusrs/DataTables/datatables.min.js"></script>

    <!-- DATE PICKER -->
    <script type="text/javascript" src="DATERANGEPICKER/moment.min.js"></script>
    <script type="text/javascript" src="DATERANGEPICKER/daterangepicker.js"></script>

    <!-- SWEET ALERT -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script type="text/javascript" src="js/jasonday-printThis-c814846/printThis.js"></script>
    <script type="text/javascript" src="js/mainjs.js"></script>
    <script src="HASH/md5.js"></script>
    <script src="HASH/aes.js"></script>
    <script src="nestle/connectionString/LOCALSTORAGE/storage.js"></script>
    <script type="text/javascript" src="web/web-commons.js"></script>
    <script type="text/javascript" src="js/bootbox.min.js"></script>
    <script type="text/javascript" src="js/scrolling.js"></script>
    <script type="text/javascript" src="constant/dynamicScript.js"></script>
    <script src="js/dynamic_route_upt.js"></script>
    <script src="js/dynamicroute_inside_details.js"></script>
    <script type="text/javascript" src="js/routeList.js"></script>

</body>
</html>